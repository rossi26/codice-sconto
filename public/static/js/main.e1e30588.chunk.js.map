{"version":3,"sources":["context/auth-context.js","pages/login.js","components/Modal/Modal.js","components/Backdrop/Backdrop.js","pages/commercianteP.js","components/Navigation/MainNavigation.js","App.js","index.js"],"names":["React","createContext","token","commId","login","logout","LoginPage","props","state","isLogin","switchModeHandler","setState","prevState","submitHandler","event","preventDefault","email","emailEl","current","value","password","passwordEl","trim","length","requestBody","query","nome","titleEl","axios","post","headers","then","response","data","context","tokenExpiration","catch","err","console","log","createRef","Fragment","className","onSubmit","this","type","id","ref","placeholder","onClick","Component","contextType","AuthContext","modal","role","title","data-dismiss","aria-label","onCancel","aria-hidden","children","canCancel","canConfirm","onConfirm","backdrop","CommPage","creating","codici","startCreateHandler","modalConfirmHandler","entitasconto","entitascontoEl","messaggio","messaggioEl","validita","validitaEl","fetchCodici","onCancelCode","codeId","modalCancelHandler","codeList","map","codice","href","encodeURI","key","_id","code","mainNavigation","Consumer","data-toggle","data-target","aria-controls","aria-expanded","to","App","refreshToken","t","localStorage","getItem","Promise","resolve","setItem","removeItem","result","base64","split","replace","tokenData","JSON","parse","atob","Provider","from","exact","path","component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e1e30588.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nexport default React.createContext({\r\n    token:null,\r\n    commId:null,\r\n    login:()=>{},\r\n    logout:()=>{}\r\n    \r\n});","import React, {Component} from 'react';\r\nimport './login.css'\r\nimport axios from 'axios';\r\nimport AuthContext from '../context/auth-context'\r\n\r\n\r\nclass LoginPage extends Component{\r\n    state={\r\n      isLogin:true\r\n    }\r\n    static contextType= AuthContext;\r\n\r\n\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.emailEl = React.createRef();\r\n        this.passwordEl = React.createRef();\r\n        this.titleEl = React.createRef();\r\n        \r\n      }\r\n      switchModeHandler =()=>{\r\n        this.setState(prevState =>{\r\n          return{isLogin:!prevState.isLogin}\r\n        })\r\n      }\r\n\r\n     \r\n\r\n\r\n      submitHandler = event => {\r\n        event.preventDefault();\r\n        const email = this.emailEl.current.value;\r\n        const password = this.passwordEl.current.value;\r\n        \r\n        if (email.trim().length === 0 || password.trim().length === 0) {\r\n          return;\r\n        }\r\n\r\n      \r\n     let requestBody = {\r\n          query:`\r\n          query{\r\n            login(email:\"${email}\",password:\"${password}\"){\r\n              commId\r\n              token\r\n              tokenExpiration\r\n            }\r\n          }`\r\n        }\r\n       \r\n        if(!this.state.isLogin){\r\n         \r\n          const nome=this.titleEl.current.value;\r\n            requestBody={\r\n            query:`\r\n            mutation{\r\n                createComm(commInput:{ title:\"${nome}\" , email:\"${email}\" , password:\"${password}\" }){\r\n                    _id\r\n                    email\r\n                }\r\n            }\r\n            `\r\n        }\r\n    \r\n    }\r\n        \r\n       \r\n        axios.post('/graphql',\r\n          requestBody\r\n          ,\r\n          {\r\n             headers: {\r\n            'Content-Type': 'application/json'\r\n            }\r\n          }\r\n        )\r\n        .then(response => {\r\n          \r\n          if (response.data.data.login.token){\r\n            this.context.login(\r\n              response.data.data.login.token,\r\n              response.data.data.login.commId,\r\n              response.data.data.login.tokenExpiration)\r\n          }\r\n        \r\n        })\r\n        .catch(err => {\r\n          console.log(err, err.response);\r\n        }); \r\n      \r\n    };\r\n\r\n    render(){ \r\n        return(<React.Fragment>\r\n            <form className=\"auth-form\" onSubmit={this.submitHandler}>\r\n            <div className=\"form-group\">\r\n              \r\n              <input type=\"email\" className=\"form-control\" id=\"email\" ref={this.emailEl} placeholder=\"Email\"/>\r\n            </div>\r\n            \r\n              <div className=\"form-group\">\r\n                \r\n                <input type=\"password\" className=\"form-control\" id=\"password\" ref={this.passwordEl} placeholder=\"Password\"/>\r\n              </div>\r\n              {this.state.isLogin ? (null):\r\n              (<React.Fragment>\r\n              \r\n             \r\n    \r\n            <div className=\"form-group\">\r\n              \r\n              <input type=\"text\" className=\"form-control\" id=\"nome\" ref={this.titleEl} placeholder=\"Nome\" />\r\n            </div>\r\n            </React.Fragment>\r\n              )\r\n              }\r\n          \r\n            <div className=\"form-actions\">\r\n              <button className=\"btn btn-primary\" type=\"submit\">Submit</button>\r\n             <button className=\"btn btn-primary\" onClick={this.switchModeHandler} >\r\n               Switch to {this.state.isLogin ? 'Signup' : 'Login'} \r\n              </button>\r\n            </div>\r\n          </form>\r\n          <section>\r\n             <div>\r\n              \r\n\r\n             </div>\r\n          </section>\r\n          </React.Fragment>\r\n\r\n        )\r\n    }\r\n}\r\nexport default LoginPage","import React from 'react';\n\nimport './Modal.css';\n\nconst modal = props => (\n  <div className=\"modal\" >\n    <div className=\"modal-dialog\" role=\"document\">\n    <div className=\"modal-content\">\n      <header className=\"modal-header\" >\n      <h1 className=\"modal-title\">{props.title}</h1>\n      <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" onClick={props.onCancel}>\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n    </header>\n    <section className=\"modal-body\" >{props.children}</section>\n    <section className=\"modal-footer\">\n      {props.canCancel && (\n        <button className=\"btn btn-secondary\" data-dismiss=\"modal\" onClick={props.onCancel}>\n          Cancel\n        </button>\n      )}\n      {props.canConfirm && (\n        <button type=\"button\" className=\"btn btn-primary\" onClick={()=>props.onConfirm()}>\n          Confirm\n        </button>\n      )}\n    </section>\n    </div>\n    </div>\n  </div>\n);\n\nexport default modal;","import React from 'react';\n\nimport './Backdrop.css';\n\nconst backdrop = props => <div className=\"backdrop\"></div>;\n\nexport default backdrop;","import React, {Component} from 'react';\r\nimport Modal from '../components/Modal/Modal';\r\nimport Backdrop from '../components/Backdrop/Backdrop';\r\nimport axios from 'axios';\r\nimport AuthContext from '../context/auth-context'\r\nimport './commercianteP.css'\r\nimport {NavLink} from 'react-router-dom'\r\n\r\nclass CommPage extends Component{\r\n     state = {\r\n        creating: false,\r\n        codici: []\r\n      };\r\n      constructor(props){\r\n        super(props);\r\n        this.entitascontoEl = React.createRef();\r\n        this.messaggioEl = React.createRef();\r\n        this.validitaEl = React.createRef();\r\n      }\r\n      static contextType= AuthContext;\r\n      componentDidMount() {\r\n        this.fetchCodici();\r\n      }\r\n    \r\n      startCreateHandler = () => {\r\n        this.setState({ creating: true });\r\n      };\r\n    \r\n      modalConfirmHandler = () => {\r\n        this.setState({ creating: false });\r\n        const entitasconto = this.entitascontoEl.current.value;\r\n        const messaggio = this.messaggioEl.current.value;\r\n        const validita=this.validitaEl.current.value;\r\n\r\n        if (entitasconto.trim().length === 0 || messaggio.trim().length === 0||validita.trim().length === 0 ) {\r\n            return;\r\n          }\r\n\r\n          const  requestBody={\r\n              query:`\r\n              mutation{\r\n                createCode(codeInput:{ entitasconto:\"${entitasconto}\" , messaggio:\"${messaggio}\" , validita:\"${validita}\" }){\r\n                      _id\r\n                      code\r\n                      validita\r\n                      entitasconto\r\n                      messaggio\r\n                  }\r\n              }\r\n              `\r\n          }\r\n        \r\n          const token=this.context.token\r\n          \r\n         \r\n          axios.post('/graphql',\r\n            requestBody\r\n            ,\r\n            {\r\n               headers: {\r\n              'Content-Type': 'application/json',\r\n              'Authorization': 'Bearer'+token\r\n              }\r\n            }\r\n          )\r\n          .then(response => {\r\n            this.fetchCodici();\r\n          \r\n          })\r\n          .catch(err => {\r\n            console.log(err, err.response);\r\n          });\r\n\r\n\r\n      };\r\n\r\n      onCancelCode=(codeId)=>{\r\n        console.log(codeId)\r\n\r\n        const  requestBody={\r\n          query:`\r\n          mutation{\r\n            cancelCode( codeId:\"${codeId}\"){\r\n                  _id\r\n                 title\r\n                 email\r\n              }\r\n          }\r\n          `\r\n        }\r\n\r\n        const token=this.context.token\r\n          \r\n         \r\n          axios.post('/graphql',\r\n            requestBody\r\n            ,\r\n            {\r\n               headers: {\r\n              'Content-Type': 'application/json',\r\n              'Authorization': 'Bearer'+token\r\n              }\r\n            }\r\n          )\r\n          .then(response => {\r\n            this.fetchCodici();\r\n          \r\n          })\r\n          .catch(err => {\r\n            console.log(err, err.response);\r\n          });\r\n\r\n\r\n      }\r\n    \r\n      modalCancelHandler = () => {\r\n        this.setState({ creating: false });\r\n      };\r\n\r\n      fetchCodici(){\r\n        const requestBody = {\r\n            query: `\r\n                query {\r\n                  codici {\r\n                    _id\r\n                    code\r\n                    entitasconto\r\n                    messaggio\r\n                    validita\r\n                    commerciante{\r\n                      email\r\n                      title\r\n                    }\r\n                    \r\n                   \r\n                  }\r\n                }\r\n              `\r\n          };\r\n\r\n          const token=this.context.token\r\n          \r\n\r\n          axios.post('/graphql',\r\n          requestBody\r\n          ,\r\n          {\r\n             headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': 'Bearer'+token\r\n            }\r\n          }\r\n        )\r\n        .then(response => {\r\n            const codici = response.data.data.codici;\r\n            \r\n            \r\n            this.setState({ codici: codici });\r\n        \r\n        })\r\n        .catch(err => {\r\n          console.log(err, err.response);\r\n        });\r\n      \r\n\r\n      } \r\n\r\n \r\n    render(){\r\n       \r\n         const codeList = this.state.codici.map(codice => {\r\n          const URLmess=encodeURI(codice.messaggio)\r\n          \r\n          const href=\"https://wa.me/?text=\"+URLmess\r\n          \r\n            return (\r\n              <li key={codice._id} className=\"card\">\r\n                \r\n                    {codice.code} <div className=\"bottoni\"> <a href={href}><button className=\"btn btn-primary\">Condividi</button></a>\r\n                    <button className=\"btn btn-primary\" onClick={()=>{this.onCancelCode(codice._id)}}>Brucia Codice</button></div>\r\n              </li>\r\n            );\r\n          });\r\n\r\n        return(\r\n            \r\n           \r\n            <React.Fragment>\r\n        {this.state.creating && <Backdrop />}\r\n        {this.state.creating && (<Modal\r\n            title=\"Add codici\"\r\n            canCancel\r\n            canConfirm\r\n            onCancel={this.modalCancelHandler}\r\n            onConfirm={this.modalConfirmHandler}\r\n          >\r\n            <form>\r\n            <div className=\"form-group\">\r\n                <input className=\"form-control\" type=\"text\" id=\"entitascontoEl\"  ref={this.entitascontoEl} placeholder=\"entita sconto\"/>\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <input className=\"form-control\" type=\"text\" id=\"messaggioEl\" ref={this.messaggioEl}  placeholder=\"Messaggio\" />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <input className=\"form-control\" type=\"date\" id=\"validita\" ref={this.validitaEl} placeholder=\"Validita\"/>\r\n            </div>\r\n            </form>\r\n          </Modal>\r\n        )}\r\n       \r\n       {this.context.token&&(<div className=\"container\">\r\n            <button type=\"button\" className=\"btn btn-primary\" onClick={this.startCreateHandler}>Create codice</button>\r\n        </div>)} \r\n        <div className=\"accordion\" id=\"accordionExample\">\r\n        <ul>\r\n            {codeList}\r\n\r\n        </ul>\r\n        </div>\r\n        </React.Fragment> )\r\n    }\r\n}\r\nexport default CommPage","import React from 'react';//functional component\r\nimport {NavLink} from 'react-router-dom'\r\nimport './MainNavigation.css'\r\nimport AuthContext from '../../context/auth-context'\r\n\r\nconst mainNavigation = props => (\r\n<AuthContext.Consumer>\r\n    {(context)=>{\r\n        return(\r\n             <nav className=\"navbar navbar-expand-lg navbar-dark bg-primary\" id=\"main-navigation\">\r\n               <div className=\"navbar-brand\"></div>\r\n                 <button className=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarColor01\" aria-controls=\"navbarColor01\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n                        <span className=\"navbar-toggler-icon\"></span>\r\n                </button>\r\n               <div className=\"collapse navbar-collapse\" id=\"navbarColor01\">\r\n                    <ul className=\"navbar-nav mr-auto\" >\r\n                    <li className=\"nav-item\"><NavLink className=\"nav-link\" to=\"/\">Home</NavLink></li>\r\n                        {context.token&&<li className=\"nav-item\"><NavLink className=\"nav-link\" to=\"/commerciante\">Utente</NavLink></li>}\r\n                \r\n                    </ul>\r\n                    </div>\r\n                    <div className=\"authentication\">\r\n                        {!context.token&&<li className=\"nav-item\"><NavLink to=\"/login\"><button className=\"btn btn-primary\">Login</button></NavLink></li>}\r\n                        {context.token&&<li className=\"nav-item\"><button className=\"btn btn-primary\"  onClick={context.logout}>Logout</button></li>}\r\n                    </div>  \r\n                </nav>\r\n          \r\n        )\r\n    }}\r\n\r\n</AuthContext.Consumer>\r\n\r\n);\r\n\r\n\r\n\r\nexport default mainNavigation","import React, { Component } from 'react';\nimport {BrowserRouter,Route, Redirect, Switch} from 'react-router-dom';\nimport LoginPage from './pages/login'\nimport CommPage from './pages/commercianteP'\nimport AuthContext from './context/auth-context'\nimport MainNavigation from './components/Navigation/MainNavigation'\n\nimport './App.css';\n\nclass App extends Component{\n\n  state ={\n    token:null,\n    commId:null,\n    \n  }\n\n  componentDidMount() {\n    /* console.log(\"App.componentDidMount: refreshing, then authenticating..\"); */\n    this.refreshToken().then(result => {\n      console.log(result)\n        if (result) {\n\n          let base64Url = result.split(\".\")[1];\n    \n    \n    const base64 = base64Url.replace(\"-\", \"+\").replace(\"_\", \"/\");\n   \n    const tokenData = JSON.parse(atob(base64));\n           /*  console.log(\"App.componentDidMount: the user is authenticated\"); */\n               this.setState({\n              token:result,\n              commId:tokenData.commId,\n              \n            }) \n        } else {\n            /* console.log(\"App.componentDidMount: the user is not authenticated\"); */\n        }\n    });\n}\n\nrefreshToken = () => {\nconst t=localStorage.getItem(\"tokens\")\nconsole.log(t)\n /*  const tokens = JSON.parse(localStorage.getItem(\"tokens\"));\n  console.log(tokens) */\n  if (t !== null) {\n    \n\n    /*   console.log(\"App.refreshToken: access token not expired, nothing to do.\"); */\n      return Promise.resolve(t)\n   \n  }else{\n  /* console.log(\"App.refreshToken: no tokens found in localStorage.\"); */\n  return Promise.resolve(false);}\n};\n\n  login=(token, commId, tokenExpiration)=>{\n    localStorage.setItem(\"tokens\", token)\n    this.setState({\n      token:token,\n      commId:commId,\n      tokenExpiration:tokenExpiration\n    })\n\n\n  }\n  logout=()=>{\n    localStorage.removeItem(\"tokens\");\n    this.setState({\n      token:null,\n      commId:null\n    })\n   \n\n  }\n  \n \n\n  render(){\n  return (\n    <BrowserRouter>\n    <React.Fragment>\n      <AuthContext.Provider value={{\n        token:this.state.token, \n        commId:this.state.commId,\n        login:this.login,\n        logout:this.logout,\n      }}>\n      <MainNavigation/>\n       <main className=\"main-content\">\n        <Switch>\n        {!this.state.token&&<Redirect from= \"/\" to=\"/login\" exact />}\n        {!this.state.token&&<Redirect from= \"/commerciante\" to=\"/login\" exact />}\n        {this.state.token&&<Redirect from= \"/\" to=\"/commerciante\" exact />}\n        {this.state.token&&<Redirect from= \"/login\" to=\"/commerciante\" exact />}\n        {!this.state.token&&<Route path=\"/login\" component={LoginPage} />}\n        {this.state.token&&<Route path=\"/commerciante\" component={CommPage} />}\n        </Switch>\n        </main>\n        </AuthContext.Provider>\n      </React.Fragment>\n    </BrowserRouter>\n  );\n}\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}